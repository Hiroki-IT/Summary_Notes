# 目次

<!-- TOC -->

- [01-01. テストの手順](#01-01-テストの手順)
- [01-02. PHPUnitによるテスト](#01-02-phpunitによるテスト)
    - [:pushpin: Unit テストの実装方法](#pushpin-unit-テストの実装方法)
    - [:pushpin: Functional テストの実装方法](#pushpin-functional-テストの実装方法)
    - [:pushpin: CIツールによるPHPUnitの自動実行](#pushpin-ciツールによるphpunitの自動実行)
- [01-03. テスト仕様書に基づくUnit テスト](#01-03-テスト仕様書に基づくunit-テスト)
    - [:pushpin: ブラックボックステスト](#pushpin-ブラックボックステスト)
    - [:pushpin: ホワイトボックステスト](#pushpin-ホワイトボックステスト)
- [01-04. テスト仕様書に基づくIntegration テスト（結合テスト）](#01-04-テスト仕様書に基づくintegration-テスト結合テスト)
    - [:pushpin: Top-down テスト](#pushpin-top-down-テスト)
    - [:pushpin: Bottom-up テスト](#pushpin-bottom-up-テスト)
    - [:pushpin: Scenario テスト](#pushpin-scenario-テスト)
- [01-04. テスト仕様書に基づくUser Acceptance テスト（総合テスト）](#01-04-テスト仕様書に基づくuser-acceptance-テスト総合テスト)
    - [:pushpin: Functional テスト](#pushpin-functional-テスト)
    - [:pushpin: Perfomance テスト](#pushpin-perfomance-テスト)
    - [:pushpin: Stress テスト](#pushpin-stress-テスト)
- [01-05. Regression テスト（退行テスト）](#01-05-regression-テスト退行テスト)
- [02-01. グラフによるテストの可視化](#02-01-グラフによるテストの可視化)
    - [:pushpin: バグ管理図](#pushpin-バグ管理図)

<!-- /TOC -->

## 01-01. テストの手順

1. テスティングフレームワークによるテストを行う．
2. テスト仕様書に基づくUnitテスト，Integrationテスト，User Acceptanceテストを行う．
3. グラフによるテストの可視化

 

## 01-02. PHPUnitによるテスト

https://phpunit.readthedocs.io/ja/latest/assertions.html

### :pushpin: Unit テストの実装方法

クラスやメソッドが単体で正しく動作するかをテストする．

```PHP
// ここに実装例
```



### :pushpin: Functional テストの実装方法

リクエストされるControllerからデータベースまでの，一連の処理に関わるクラスやメソッドが正しく動作するかをテストする．期待値のデータセットを```@dataProvider```に定義し，データベースからレスポンスされた実際の値と一致するかでテストを行う．

```PHP
// ここに実装例
```



### :pushpin: CIツールによるPHPUnitの自動実行

1. テストクラスを実装したうえで，新機能を設計実装する．

2. リポジトリへPushすると，CIツールがGituHubからブランチの状態を取得する．

3. CIツールによって，テストサーバの仮想化，インタプリタ，PHPUnitなどが自動実行される．

4. 結果を通知することも可能．

**【自動化ツールアプリ例】**

Circle CI，Jenkins

![継続的インテグレーション](https://raw.githubusercontent.com/Hiroki-IT/tech-notebook/master/markdown/image/継続的インテグレーション.png)



## 01-03. テスト仕様書に基づくUnit テスト

PHPUnitでのUnitテストとは意味合いが異なるので注意．

### :pushpin: ブラックボックステスト

実装内容は気にせず，入力に対して，適切な出力が行われているかをテストする．

![p492-1](https://raw.githubusercontent.com/Hiroki-IT/tech-notebook/master/markdown/image/p492-1.jpg)



### :pushpin: ホワイトボックステスト

実装内容が適切かを確認しながら，入力に対して，適切な出力が行われているかをテストする．ホワイトボックステストには，以下の方法がある．何をテストするかに着目すれば，思い出しやすい．

![p492-2](https://raw.githubusercontent.com/Hiroki-IT/tech-notebook/master/markdown/image/p492-2.jpg)

**【実装例】**

```
if (A = 1 && B = 1) {
　return X;
}
```

上記のif文におけるテストとして，以下の４つの方法が考えられる．基本的には，複数条件網羅が用いられる．

- **命令網羅（『全ての処理』が実行されるかをテスト）**

![p494-1](https://raw.githubusercontent.com/Hiroki-IT/tech-notebook/master/markdown/image/p494-1.png)

全ての命令が実行されるかをテスト（ここでは処理は1つ）．

すなわち…

A = 1，B = 1 の時，```return X``` が実行されること．

- **判定条件網羅（『全ての判定』が実行されるかをテスト）**

![p494-2](https://raw.githubusercontent.com/Hiroki-IT/tech-notebook/master/markdown/image/p494-2.png)

全ての判定が実行されるかをテスト（ここでは判定は```TRUE```か```FALSE```の2つ）．

すなわち…

A = 1，B = 1 の時，```return X``` が実行されること．
A = 1，B = 0 の時，```return X``` が実行されないこと．

- **条件網羅（『各条件の取り得る全ての値』が実行されるかをテスト）**

![p494-3](https://raw.githubusercontent.com/Hiroki-IT/tech-notebook/master/markdown/image/p494-3.png)

各条件が，取り得る全ての値で実行されるかをテスト（ここでは，Aが0と1，Bが0と1になる組み合わせなので，2つ）

すなわち…

A = 1，B = 0 の時，```return X``` が実行されないこと．
A = 0，B = 1 の時，```return X``` が実行されないこと．

または，次の組み合わせでもよい．

A = 1，B = 1 の時，```return X``` が実行されること．
A = 0，B = 0 の時，```return X``` が実行されないこと．

- **複数条件網羅（『各条件が取り得る全ての値』，かつ『全ての組み合わせ』が実行されるかをテスト）**

![p494-4](https://raw.githubusercontent.com/Hiroki-IT/tech-notebook/master/markdown/image/p494-4.png)

各条件が，取り得る全ての値で，かつ全ての組み合わせが実行されるかをテスト（ここでは4つ）

すなわち…

A = 1，B = 1 の時，```return X``` が実行されること．
A = 1，B = 0 の時，```return X``` が実行されないこと．
A = 0，B = 1 の時，```return X``` が実行されないこと．
A = 0，B = 0 の時，```return X``` が実行されないこと．

 

## 01-04. テスト仕様書に基づくIntegration テスト（結合テスト）

単体テストの次に行うテスト．複数のモジュールを繋げ，モジュール間のインターフェイスが適切に動いているかを検証．

![結合テスト](https://raw.githubusercontent.com/Hiroki-IT/tech-notebook/master/markdown/image/p491-1.jpg)

### :pushpin: Top-down テスト

上位のモジュールから下位のモジュールに向かって，結合テストを行う場合，下位には Stub と呼ばれるダミーモジュールを作成する．

![トップダウンテスト](https://raw.githubusercontent.com/Hiroki-IT/tech-notebook/master/markdown/image/トップダウンテスト.jpg)



### :pushpin: Bottom-up テスト

下位のモジュールから上位のモジュールに向かって，結合テストを行う場合，上位には Driver と呼ばれるダミーモジュールを作成する．

![ボトムアップテスト](https://raw.githubusercontent.com/Hiroki-IT/tech-notebook/master/markdown/image/ボトムアップテスト.jpg)



### :pushpin: Scenario テスト

実際の業務フローを参考にし，ユーザが操作する順にテストを行う．




## 01-04. テスト仕様書に基づくUser Acceptance テスト（総合テスト）

![p491-2](https://raw.githubusercontent.com/Hiroki-IT/tech-notebook/master/markdown/image/p491-2.jpg)

結合テストの次に行うテスト．システム全体が適切に動いているかをテストする．



### :pushpin: Functional テスト

機能要件を満たせているかをテストする．PHPUnitでのFunctionalテストとは意味合いが異なるので注意．



### :pushpin: Perfomance テスト

![スループットとレスポンスタイム](https://raw.githubusercontent.com/Hiroki-IT/tech-notebook/master/markdown/image/スループットとレスポンスタイム.png)

非機能要件の一つである性能要件（スループット，レスポンスタイム，メモリのリソース量）を満たせているかをテストする．性能を評価する時，アクセス数を段階的に増加させて数回の性能テストを実施し，その結果を組み合わせてグラフ化する．例えば，性能目標を，⁠スループット：50件／秒⁠，⁠レスポンスタイム：3秒以内とする．今回のグラフでは，スループット：50件／秒の時のレスポンスタイムは2秒である．したがって，このシステムは性能目標を達成していることがわかる．

- **Throughput**

  単位時間当たりに処理できる仕事数のこと．

- **Response time**

  コンピュータが処理を終えるまでに要する時間のこと．



### :pushpin: Stress テスト



## 01-05. Regression テスト（退行テスト）

システムを変更した後，他のプログラムに悪影響を与えていないかを検証．

![p496](https://raw.githubusercontent.com/Hiroki-IT/tech-notebook/master/markdown/image/p496.jpg)



## 02-01. グラフによるテストの可視化

### :pushpin: バグ管理図

プロジェクトの時，残存テスト数と不良摘出数（バグ発見数）を縦軸にとり，時間を横軸にとることで，バグ管理図を作成する．それぞれの曲線の状態から，プロジェクトの進捗状況を読み取ることができる．

![品質管理図](https://raw.githubusercontent.com/Hiroki-IT/tech-notebook/master/markdown/image/品質管理図.jpg)

不良摘出実績線（信頼度成長曲線）は，プログラムの品質の状態を表し，S字型でないものはプログラムの品質が良くないことを表す．

![信頼度成長曲線の悪い例](https://raw.githubusercontent.com/Hiroki-IT/tech-notebook/master/markdown/image/信頼度成長曲線の悪い例.jpg)



